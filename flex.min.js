!function(t){"use strict";function e(){this.controller=a.create(this),this.initialState={},this.__state__={},this.set(this.getInitialState())}function n(t){if(!i(t)&&!r(t))return t;for(var e=0;e<arguments.length;){var n=arguments[e++];for(var o in n)t[o]=n[o]}return t}function i(t){return t&&"object"==typeof t}function r(t){return t&&"function"==typeof t}function o(t){return t&&"string"==typeof t}var s,a,u={};"function"==typeof define&&define.amd?define(["davy","streamlet"],function(t,e){return s=t,a=e,u}):"object"==typeof module&&module.exports?(s=require("davy"),a=require("streamlet"),module.exports=u):(s=t.Davy,a=t.Streamlet,t.Flex=u),u.createStore=function(t){var i=n(new e,t);return i.set(i.getInitialState()),r(t.initialize)&&t.initialize.call(i),i},u.createAction=function(t,e){r(e)||(e=function(t){return t});var i=a.create(!0),o=i.stream,u=function(t){return new s(function(n){n(e(t))}).then(function(t){return i.next(t),t},function(t){throw i.fail(t),t})},c={actionName:t,listen:function(){o.listen.apply(o,arguments)}};return n(u,c)},u.createActions=function(t,e){e||(e="");var r={};for(var s in t){var a=t[s],u=o(a)?a:s,c=e+u;if(i(a)){var f=a.$;delete a.$,r[u]=n(this.createAction(c,f),this.createActions(a,c))}else r[u]=this.createAction(c,a)}return r},u.save=u.saveState=function(t){return JSON.stringify(t.get())},u.restore=u.restoreState=function(t,e){t.set(i(e)?e:JSON.parse(e))},u.Promise=s,u.Stream=a,u.Store=e,u.ListenerMixin={componentWillMount:function(){this.subscriptions=[]},componentWillUnmount:function(){for(var t=0;t<this.subscriptions.length;)this.subscriptions[t++]()},listenTo:function(t,e){this.subscriptions.push(t.listen(e))}},e.prototype.getInitialState=function(){return Object.create(this.initialState)},e.prototype.get=e.prototype.getState=function(){return this.__state__},e.prototype.set=e.prototype.setState=function(t){if(i(t)){for(var e in t)this.__state__[e]=t[e];return this.controller.add(t),this.__state__}},e.prototype.reset=e.prototype.resetState=function(){return this.__state__={},this.set(this.getInitialState())},e.prototype.listen=function(t){return this.controller.stream.listen(t)},e.prototype.listenTo=function(t,e,n){return r(e)&&(e=e.bind(this)),r(n)&&(n=n.bind(this)),t.listen(e,n)}}(this);
//# sourceMappingURL=flex.min.js.map