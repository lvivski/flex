!function(t){"use strict";function e(){this.controller=c.controlSync(),this.initialState={},this.__state__={},this.set(this.getInitialState())}function n(t){if(!r(t)&&!i(t))return t;for(var e=1;e<arguments.length;){var n=arguments[e++];for(var o in n)if(n.hasOwnProperty(o))if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var s=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(t,o,s||{})}else t[o]=n[o]}return t}function r(t){return t&&"object"==typeof t}function i(t){return t&&"function"==typeof t}function o(t){return t&&"string"==typeof t}function s(t){return function(e){return function(){return t(e)}}}var a,c,u={};"function"==typeof define&&define.amd?define(["davy","streamlet"],function(t,e){return a=t,c=e,u}):"object"==typeof module&&module.exports?(a=require("davy"),c=require("streamlet"),module.exports=u):(a=t.Davy,c=t.Streamlet,t.Flex=u),u.createStore=function(t){var r;if("object"!=typeof t){if(!(t.prototype instanceof e))throw new TypeError("Store should have Flex.Store in prototype chain");r=new t}else r=n(new e,t),r.set(r.getInitialState()),i(t.initialize)&&t.initialize.call(r);return r},u.createAction=function(t,e){i(e)||(e=function(t){return t});var r=c.controlSync(),o=r.stream,u=function(t){return r.next(t),t},f=function(t){throw r.fail(t),t},p=function(t){return new a(function(n){n(e(t))}).then(u,f).then(s(u),s(f))},l={actionName:t,listen:function(){o.listen.apply(o,arguments)}};return n(p,l)},u.createActions=function(t,e){e||(e="");var i={};for(var s in t)if(t.hasOwnProperty(s)){var a=t[s],c=o(a)?a:s,u=e+c;if(r(a)){var f=a.$;delete a.$,i[c]=n(this.createAction(u,f),this.createActions(a,u))}else i[c]=this.createAction(u,a)}return i},u.save=u.saveState=function(t){return JSON.stringify(t.get())},u.restore=u.restoreState=function(t,e){t.set(r(e)?e:JSON.parse(e))},u.Promise=a,u.Observable=c,u.Store=e,u.ListenerMixin={componentWillMount:function(){this.subscriptions=[]},componentWillUnmount:function(){for(var t=0;t<this.subscriptions.length;)this.subscriptions[t++]()},listenTo:function(t,e){this.subscriptions.push(t.listen(e))}},e.prototype.getInitialState=function(){return JSON.parse(JSON.stringify(this.initialState))},e.prototype.get=e.prototype.getState=function(){return this.__state__},e.prototype.set=e.prototype.setState=function(t){if(r(t)){for(var e in t)t.hasOwnProperty(e)&&(this.__state__[e]=t[e]);return this.controller.add(t),this.__state__}},e.prototype.reset=e.prototype.resetState=function(){return this.__state__={},this.set(this.getInitialState())},e.prototype.listen=function(t){return this.controller.stream.listen(t)},e.prototype.listenTo=function(t,e,n){if(i(t)&&o(t.actionName)&&(e=e||this["on"+t.actionName],n=n||this["on"+t.actionName+"Fail"],(i(e)||i(n))&&t.listen(e&&e.bind(this),n&&n.bind(this))),1===arguments.length&&(i(t)||r(t)))for(var s in t)t.hasOwnProperty(s)&&this.listenTo(t[s])}}(this);
//# sourceMappingURL=flex.min.js.map