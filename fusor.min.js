!function(t){"use strict";function e(){}function n(){var t=this.constructor.prototype;for(var n in t)t.hasOwnProperty(n)&&"constructor"!==n&&s(this[n])&&(this[n]=e.createAction(n,this[n]))}function r(){this.initialState||(this.initialState={});var t=p.control(!0);this.stream=t.stream,this.add=t.add.bind(t),this.__state__={},this.set(this.getInitialState())}function i(t){if(!o(t)&&!s(t))return t;for(var e=1;e<arguments.length;){var n=arguments[e++];for(var r in n)if(n.hasOwnProperty(r))if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i||{})}else t[r]=n[r]}return t}function o(t){return t&&"object"==typeof t}function s(t){return t&&"function"==typeof t}function a(t){return t&&"string"==typeof t}function c(t){return t}var u,p;"function"==typeof define&&define.amd?define(["davy","streamlet"],function(t,n){return u=t,p=n,e}):"object"==typeof module&&module.exports?(u=require("davy"),p=require("streamlet"),module.exports=e):(u=t.Davy,p=t.Streamlet,t.Fusor=e),e.createStore=function(t){return s(t)?(i(t.prototype,r.prototype),t=new t):(t=i(new r,t),s(t.initialize)&&t.initialize.call(t)),r.call(t),t},e.createAction=function(t,e){s(e)||(e=c);var n=p.control(!0),r=n.stream,o=function(t){return n.next(t),t},a=function(t){throw n.fail(t),t},f=function(){var t=arguments,n=this;return new u(function(r){r(e.apply(n,t))}).then(o,a)},l={actionType:t,stream:r};return i(f,l)},e.createActions=function(t,e){e||(e="");var r={};if(s(t))i(t.prototype,n.prototype),r=new t;else for(var c in t)if(t.hasOwnProperty(c)){var u=t[c],p=a(u)?u:c,f=e+p;if(o(u)){var l=u.$;delete u.$,r[p]=i(this.createAction(f,l),this.createActions(u,f))}else r[p]=this.createAction(f,u)}return r},e.save=e.saveState=function(t){return JSON.stringify(t.get())},e.restore=e.restoreState=function(t,e){t.set(o(e)?e:JSON.parse(e))},e.replay=e.replayActions=function(t){return u.all(t)},e.Promise=u,e.Observable=p,e.Store=r,e.Actions=n,e.ListenerMixin={componentWillMount:function(){this.subscriptions=[]},componentWillUnmount:function(){for(var t=0;t<this.subscriptions.length;)this.subscriptions[t++]()},listenTo:function(t,e){this.subscriptions.push(t.stream.listen(e))}},r.prototype.getInitialState=function(){return JSON.parse(JSON.stringify(this.initialState||{}))},r.prototype.get=r.prototype.getState=function(){return this.__state__},r.prototype.set=r.prototype.setState=function(t){return o(t)?(this.add(t),i(this.__state__,t)):void 0},r.prototype.reset=r.prototype.resetState=function(){return this.__state__={},this.set(this.getInitialState())},r.prototype.listenTo=function(t,e,n){if(s(t)&&a(t.actionType)){var r=t.actionType;r=r[0].toUpperCase()+r.slice(1),e=e||this["on"+r],n=n||this["on"+r+"Fail"],(s(e)||s(n))&&t.stream.listen(e&&e.bind(this),n&&n.bind(this))}if(1===arguments.length&&(s(t)||o(t)))for(var i in t)t.hasOwnProperty(i)&&this.listenTo(t[i])}}(Function("return this")());
//# sourceMappingURL=fusor.min.js.map