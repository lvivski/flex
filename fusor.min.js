!function(t){"use strict";function e(){}function n(){for(var t in this.constructor.prototype)"constructor"!==t&&s(this[t])&&(this[t]=e.createAction(t,this[t]))}function i(){this.initialState||(this.initialState={}),this.__controller__=f.control(!0),this.__state__={},this.set(this.getInitialState())}function r(t){if(!o(t)&&!s(t))return t;for(var e=1;e<arguments.length;){var n=arguments[e++];for(var i in n)if(n.hasOwnProperty(i))if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r||{})}else t[i]=n[i]}return t}function o(t){return t&&"object"==typeof t}function s(t){return t&&"function"==typeof t}function a(t){return t&&"string"==typeof t}function c(t){return t}var u,f;"function"==typeof define&&define.amd?define(["davy","streamlet"],function(t,n){return u=t,f=n,e}):"object"==typeof module&&module.exports?(u=require("davy"),f=require("streamlet"),module.exports=e):(u=t.Davy,f=t.Streamlet,t.Fusor=e),e.createStore=function(t){return s(t)?(r(t.prototype,i.prototype),t=new t):(t=r(new i,t),s(t.initialize)&&t.initialize.call(t)),i.call(t),t},e.createAction=function(t,e){s(e)||(e=c);var n=f.control(!0),i=n.stream,o=function(t){return n.next(t),t},a=function(t){throw n.fail(t),t},p=function(){var t=arguments,n=this;return new u(function(i){i(e.apply(n,t))}).then(o,a)},l={actionName:t,listen:function(t,e){return i.listen(t,e)}};return r(p,l)},e.createActions=function(t,e){e||(e="");var i={};if(s(t))r(t.prototype,n.prototype),i=new t;else for(var c in t)if(t.hasOwnProperty(c)){var u=t[c],f=a(u)?u:c,p=e+f;if(o(u)){var l=u.$;delete u.$,i[f]=r(this.createAction(p,l),this.createActions(u,p))}else i[f]=this.createAction(p,u)}return i},e.save=e.saveState=function(t){return JSON.stringify(t.get())},e.restore=e.restoreState=function(t,e){t.set(o(e)?e:JSON.parse(e))},e.replay=e.replayActions=function(t){return u.all(t)},e.Promise=u,e.Observable=f,e.Store=i,e.Actions=n,e.ListenerMixin={componentWillMount:function(){this.subscriptions=[]},componentWillUnmount:function(){for(var t=0;t<this.subscriptions.length;)this.subscriptions[t++]()},listenTo:function(t,e){this.subscriptions.push(t.listen(e))}},i.prototype.getInitialState=function(){return JSON.parse(JSON.stringify(this.initialState||{}))},i.prototype.get=i.prototype.getState=function(){return this.__state__},i.prototype.set=i.prototype.setState=function(t){return o(t)?(r(this.__state__,t),this.__controller__.add(t),this.__state__):void 0},i.prototype.reset=i.prototype.resetState=function(){return this.__state__={},this.set(this.getInitialState())},i.prototype.listen=function(t){return this.__controller__.stream.listen(t)},i.prototype.listenTo=function(t,e,n){if(s(t)&&a(t.actionName)){var i=t.actionName;i=i[0].toUpperCase()+i.slice(1),e=e||this["on"+i],n=n||this["on"+i+"Fail"],(s(e)||s(n))&&t.listen(e&&e.bind(this),n&&n.bind(this))}if(1===arguments.length&&(s(t)||o(t)))for(var r in t)t.hasOwnProperty(r)&&this.listenTo(t[r])}}(this);
//# sourceMappingURL=fusor.min.js.map